<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ† Ù„ÛŒÚ¯ Ù‚Ù‡Ø±Ù…Ø§Ù†Ø§Ù† - Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</title>
    <!-- Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <link href="https://cdn.fontcdn.ir/Font/Persian/Vazir/Vazir-FD.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Vazir FD', 'Vazir', sans-serif;
            background: #0a0f1f;
            background-image: 
                radial-gradient(circle at 20% 40%, #3b0764 0%, transparent 30%),
                radial-gradient(circle at 80% 70%, #7e22ce 0%, transparent 35%),
                linear-gradient(145deg, #030712 0%, #111827 100%);
            min-height: 100vh;
            padding: 15px;
            color: white;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Ù…ÙˆØ¯Ø§Ù„ ÙˆØ±ÙˆØ¯ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .modal-overlay.active {
            display: flex;
        }

        .login-modal {
            background: #1f2937;
            border-radius: 60px;
            padding: 50px;
            max-width: 450px;
            width: 90%;
            border: 3px solid #fbbf24;
            box-shadow: 0 0 70px #fbbf24;
            text-align: center;
        }

        .login-modal h2 {
            color: #fbbf24;
            font-size: 2.5rem;
            margin-bottom: 30px;
        }

        .login-input {
            width: 100%;
            padding: 18px 25px;
            font-size: 1.2rem;
            border-radius: 60px;
            border: 2px solid #fbbf24;
            background: #111827;
            color: white;
            margin-bottom: 20px;
            font-family: 'Vazir FD', sans-serif;
            text-align: center;
            letter-spacing: 3px;
        }

        .login-btn {
            background: linear-gradient(145deg, #fbbf24, #d97706);
            border: none;
            color: black;
            padding: 15px 40px;
            border-radius: 60px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            font-family: 'Vazir FD', sans-serif;
        }

        .login-error {
            color: #ef4444;
            margin-top: 15px;
            font-size: 1rem;
        }

        /* Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª */
        .admin-bar {
            background: #1f2937;
            border-radius: 60px;
            padding: 15px 25px;
            margin-bottom: 20px;
            display: none;
            align-items: center;
            justify-content: space-between;
            border: 2px solid #fbbf24;
        }

        .admin-bar.active {
            display: flex;
        }

        .admin-badge {
            background: #fbbf24;
            color: black;
            padding: 8px 25px;
            border-radius: 40px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-btn {
            background: transparent;
            border: 2px solid #fbbf24;
            color: #fbbf24;
            padding: 8px 25px;
            border-radius: 40px;
            cursor: pointer;
            font-family: 'Vazir FD', sans-serif;
            transition: 0.3s;
        }

        .admin-btn:hover {
            background: #fbbf24;
            color: black;
        }

        /* Ø¯Ú©Ù…Ù‡ ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ± Ø¯Ø± Ù‡Ø¯Ø± */
        .admin-login-btn {
            background: transparent;
            border: 2px solid #fbbf24;
            color: #fbbf24;
            padding: 10px 30px;
            border-radius: 60px;
            font-size: 1.1rem;
            cursor: pointer;
            font-family: 'Vazir FD', sans-serif;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: 0.3s;
        }

        .admin-login-btn:hover {
            background: #fbbf24;
            color: black;
        }

        /* Ù…ÙˆØ¯Ø§Ù„ ØªØºÛŒÛŒØ± Ø±Ù…Ø² */
        .change-password-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1f2937;
            border-radius: 60px;
            padding: 40px;
            border: 3px solid #fbbf24;
            z-index: 10000;
            max-width: 450px;
            width: 90%;
            display: none;
        }

        .change-password-modal.active {
            display: block;
        }

        .close-modal {
            position: absolute;
            top: 20px;
            left: 25px;
            font-size: 2rem;
            color: #fbbf24;
            cursor: pointer;
        }

        /* Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ ØºÛŒØ±ÙØ¹Ø§Ù„ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø¹Ø§Ø¯ÛŒ */
        .editable.disabled {
            pointer-events: none;
            opacity: 0.8;
        }

        .editable.disabled input:not(.view-only):not(.stat-display),
        .editable.disabled select,
        .editable.disabled .score-inp,
        .editable.disabled .team-select,
        .editable.disabled .drag-handle,
        .editable.disabled .player-name-input,
        .editable.disabled .manager-input,
        .editable.disabled .add-player-btn,
        .editable.disabled .delete-player,
        .editable.disabled .stat-control-btn,
        .editable.disabled .description-editor,
        .editable.disabled .btn:not(.admin-login-btn),
        .editable.disabled .note-input,
        .editable.disabled .save-note-btn {
            pointer-events: none;
            background: #1f2937;
            color: #9ca3af;
            border-color: #4b5563;
        }

        /* Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ ÙÙ‚Ø· Ù†Ù…Ø§ÛŒØ´ÛŒ */
        .view-only {
            background: transparent !important;
            border: none !important;
            color: white !important;
            font-weight: normal !important;
        }

        .stat-display {
            background: transparent !important;
            border: none !important;
            color: white !important;
            font-size: 1rem !important;
            width: 40px;
            text-align: center;
        }

        .edit-notice {
            background: #3b82f6;
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 0.9rem;
            display: inline-block;
        }

        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(17, 24, 39, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 40px;
            padding: 20px 10px;
            text-align: center;
            border: 1px solid #fbbf24;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .stat-icon {
            font-size: 2rem;
            color: #fbbf24;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 900;
            color: #fbbf24;
        }

        .groups-row {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .group-card {
            flex: 1;
            min-width: 300px;
            background: rgba(17, 24, 39, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 40px;
            padding: 20px;
            border: 1px solid #fbbf24;
        }

        .group-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px dashed #fbbf24;
        }

        .group-title {
            font-size: 2rem;
            font-weight: 900;
            color: #fbbf24;
        }

        .team-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            background: #1f2937;
            border-radius: 60px;
            padding: 5px 5px 5px 15px;
        }

        .rank {
            width: 40px;
            height: 40px;
            background: #fbbf24;
            color: black;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            margin-left: 10px;
        }

        .team-input {
            background: transparent;
            border: none;
            color: white;
            flex: 1;
            padding: 8px;
            font-size: 1rem;
            font-family: 'Vazir FD', sans-serif;
        }

        .team-input:focus {
            outline: 2px solid #fbbf24;
            border-radius: 30px;
        }

        .team-stats {
            display: flex;
            gap: 10px;
            background: #111827;
            padding: 5px 15px;
            border-radius: 40px;
        }

        .stat {
            text-align: center;
            font-size: 0.8rem;
        }

        .stat-num {
            font-weight: 900;
            color: #fbbf24;
            font-size: 1.1rem;
        }

        /* Ø¨Ø®Ø´ Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø¨Ø§ Ú©Ø§Ø¯Ø± ØªÙˆØ¶ÛŒØ­Ø§Øª */
        .matches-panel {
            background: rgba(17, 24, 39, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .match-tabs {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tab-btn {
            background: #1f2937;
            border: none;
            color: white;
            padding: 10px 30px;
            border-radius: 40px;
            font-size: 1.1rem;
            cursor: pointer;
            font-family: 'Vazir FD', sans-serif;
        }

        .tab-btn.active {
            background: #fbbf24;
            color: black;
            font-weight: 700;
        }

        .sortable-matches {
            min-height: 200px;
        }

        .match-item {
            background: #1f2937;
            border-radius: 100px;
            padding: 15px 25px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 2px solid transparent;
            cursor: move;
            flex-wrap: wrap;
            gap: 15px;
            transition: all 0.3s;
        }

        .match-item:hover {
            border-color: #fbbf24;
            background: #2d3a4f;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(251, 191, 36, 0.2);
        }

        .match-teams {
            display: flex;
            align-items: center;
            gap: 20px;
            flex: 2;
            flex-wrap: wrap;
        }

        .team-badge {
            background: linear-gradient(145deg, #111827, #1f2937);
            padding: 8px 25px;
            border-radius: 50px;
            font-size: 1.1rem;
            min-width: 150px;
            text-align: center;
            border: 1px solid #fbbf24;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .vs {
            width: 45px;
            height: 45px;
            background: linear-gradient(145deg, #fbbf24, #d97706);
            color: black;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            box-shadow: 0 0 15px #fbbf24;
        }

        .match-info {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        /* Ú©Ø§Ø¯Ø± ØªÙˆØ¶ÛŒØ­Ø§Øª */
        .note-card {
            display: flex;
            align-items: center;
            background: linear-gradient(145deg, #111827, #1a2535);
            border-radius: 60px;
            padding: 5px;
            border: 2px solid #fbbf24;
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.3);
            min-width: 250px;
        }

        .note-icon {
            background: #fbbf24;
            color: black;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 5px;
        }

        .note-icon i {
            font-size: 1.2rem;
        }

        .note-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #fbbf24;
            font-family: 'Vazir FD', sans-serif;
            font-size: 0.95rem;
            padding: 8px 12px;
            min-width: 150px;
        }

        .note-input::placeholder {
            color: #6b7280;
            font-style: italic;
        }

        .note-input:focus {
            outline: none;
        }

        .save-note-btn {
            background: linear-gradient(145deg, #10b981, #059669);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 4px 10px rgba(16, 185, 129, 0.3);
            margin-left: 5px;
        }

        .save-note-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px #10b981;
        }

        .note-display {
            display: flex;
            align-items: center;
            gap: 10px;
            background: linear-gradient(145deg, #111827, #1a2535);
            border-radius: 60px;
            padding: 8px 20px;
            border: 1px solid #fbbf24;
            max-width: 300px;
            min-width: 200px;
        }

        .note-display i {
            color: #fbbf24;
            font-size: 1.1rem;
        }

        .note-display span {
            color: #fbbf24;
            font-size: 0.95rem;
            word-break: break-word;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .score-inputs {
            display: flex;
            align-items: center;
            gap: 10px;
            background: linear-gradient(145deg, #111827, #1a2535);
            padding: 5px 20px;
            border-radius: 50px;
            border: 2px solid #fbbf24;
        }

        .score-inp {
            width: 60px;
            text-align: center;
            background: transparent;
            border: none;
            color: #fbbf24;
            font-size: 1.5rem;
            font-weight: 900;
            padding: 5px;
        }

        .score-inp:focus {
            outline: 2px solid #fbbf24;
            border-radius: 20px;
        }

        .drag-handle {
            color: #fbbf24;
            font-size: 1.5rem;
            margin-right: 10px;
            cursor: grab;
        }

        /* Ø¨Ø®Ø´ ØªÛŒÙ…â€ŒÙ‡Ø§ Ùˆ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† */
        .teams-section {
            background: rgba(17, 24, 39, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .section-title i {
            font-size: 2rem;
            color: #fbbf24;
        }

        .section-title h2 {
            font-size: 2rem;
            color: #fbbf24;
        }

        .teams-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 20px;
        }

        .team-card {
            background: #1f2937;
            border-radius: 30px;
            overflow: hidden;
            border: 1px solid #fbbf24;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .team-header {
            background: linear-gradient(145deg, #fbbf24, #d97706);
            color: black;
            padding: 18px;
            font-weight: 700;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .team-manager {
            background: #111827;
            padding: 12px 15px;
            border-bottom: 1px solid #fbbf24;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .manager-label {
            color: #fbbf24;
            font-size: 0.9rem;
        }

        .manager-input {
            flex: 1;
            background: #1f2937;
            border: 1px solid #fbbf24;
            color: white;
            padding: 5px 15px;
            border-radius: 40px;
            font-family: 'Vazir FD', sans-serif;
        }

        .players-panel {
            padding: 15px;
        }

        .players-stats-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 0 5px;
            color: #fbbf24;
            font-size: 0.85rem;
        }

        .player-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            background: #111827;
            padding: 8px;
            border-radius: 50px;
            flex-wrap: wrap;
            transition: all 0.2s;
        }

        .player-row:hover {
            background: #1f2937;
            transform: translateX(-5px);
        }

        .player-name-input {
            flex: 2;
            min-width: 120px;
            background: #1f2937;
            border: 1px solid #fbbf24;
            color: white;
            padding: 6px 12px;
            border-radius: 30px;
            font-family: 'Vazir FD', sans-serif;
        }

        .stats-container {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .stat-control {
            display: flex;
            align-items: center;
            background: #0f172a;
            border-radius: 40px;
            border: 1px solid;
            overflow: hidden;
        }

        .stat-control.goal {
            border-color: #10b981;
        }
        .stat-control.yellow {
            border-color: #fbbf24;
        }
        .stat-control.red {
            border-color: #ef4444;
        }

        .stat-control-btn {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: 0.2s;
        }

        .stat-control-btn:hover {
            background: rgba(255,255,255,0.1);
        }

        .stat-control-btn.minus {
            border-left: 1px solid rgba(255,255,255,0.2);
        }
        .stat-control-btn.plus {
            border-right: 1px solid rgba(255,255,255,0.2);
        }

        .stat-value-display {
            min-width: 40px;
            text-align: center;
            font-weight: 700;
        }

        .stat-icon {
            font-size: 0.9rem;
            margin: 0 3px;
        }
        .stat-icon.goal { color: #10b981; }
        .stat-icon.yellow { color: #fbbf24; }
        .stat-icon.red { color: #ef4444; }

        .delete-player {
            color: #ef4444;
            cursor: pointer;
            font-size: 1.1rem;
            margin-right: 5px;
            transition: 0.2s;
        }

        .delete-player:hover {
            transform: scale(1.2);
        }

        .add-player-btn {
            background: transparent;
            border: 2px dashed #fbbf24;
            color: #fbbf24;
            padding: 10px;
            border-radius: 50px;
            width: 100%;
            cursor: pointer;
            margin-top: 10px;
            font-family: 'Vazir FD', sans-serif;
            transition: 0.3s;
        }

        .add-player-btn:hover {
            background: #fbbf24;
            color: black;
        }

        /* Ø¨Ø®Ø´ ØªÙˆØ¶ÛŒØ­Ø§Øª Ú©Ù„ÛŒ */
        .description-section {
            background: rgba(17, 24, 39, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .description-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .description-header i {
            font-size: 2rem;
            color: #fbbf24;
        }

        .description-header h2 {
            font-size: 2rem;
            color: #fbbf24;
        }

        .description-content {
            background: #1f2937;
            border-radius: 40px;
            padding: 20px;
            min-height: 150px;
        }

        .description-text {
            width: 100%;
            min-height: 150px;
            background: #111827;
            border: 2px solid #fbbf24;
            color: white;
            padding: 15px;
            border-radius: 30px;
            font-family: 'Vazir FD', sans-serif;
            font-size: 1rem;
            line-height: 1.8;
            resize: vertical;
        }

        .description-view {
            white-space: pre-wrap;
            line-height: 1.8;
            padding: 10px;
            color: #e5e7eb;
            background: #111827;
            border-radius: 30px;
            min-height: 150px;
        }

        /* Ù…Ø±Ø­Ù„Ù‡ Ø­Ø°ÙÛŒ */
        .knockout-panel {
            background: rgba(17, 24, 39, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .knockout-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .round-box {
            background: #1f2937;
            border-radius: 40px;
            padding: 20px;
            border: 1px solid #fbbf24;
        }

        .round-title {
            color: #fbbf24;
            font-size: 1.5rem;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid;
            margin-bottom: 15px;
        }

        .knockout-match {
            background: #111827;
            border-radius: 30px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .team-select {
            width: 100%;
            background: #1f2937;
            border: 1px solid #fbbf24;
            color: white;
            padding: 8px;
            border-radius: 30px;
            margin: 5px 0;
            font-family: 'Vazir FD', sans-serif;
        }

        /* Ù†ÙˆØ§Ø± Ø§Ø¨Ø²Ø§Ø± */
        .toolbar {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 30px 0;
        }

        .btn {
            background: linear-gradient(145deg, #fbbf24, #d97706);
            border: none;
            color: black;
            padding: 15px 40px;
            border-radius: 60px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: 0.3s;
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px #fbbf24;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid #fbbf24;
            color: #fbbf24;
        }

        .btn-outline:hover {
            background: #fbbf24;
            color: black;
        }

        .btn-sm {
            padding: 8px 20px;
            font-size: 0.9rem;
        }

        .auto-save-badge {
            background: #10b981;
            color: white;
            padding: 5px 20px;
            border-radius: 40px;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header-title {
            font-size: 3.5rem;
            font-weight: 900;
            background: linear-gradient(145deg, #fbbf24, #f59e0b, #d97706);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px #fbbf24;
        }

        .save-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #10b981;
            margin-left: 5px;
            animation: pulse 1.5s infinite;
        }

        .github-note {
            background: #1f2937;
            border-radius: 60px;
            padding: 15px 25px;
            margin: 20px 0;
            border: 2px solid #fbbf24;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .github-note i {
            color: #fbbf24;
            font-size: 1.5rem;
        }

        .github-note span {
            color: #e5e7eb;
            font-size: 1rem;
        }

        .github-btn {
            background: #24292e;
            color: white;
            padding: 10px 25px;
            border-radius: 40px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: 0.3s;
        }

        .github-btn:hover {
            background: #000;
            transform: scale(1.05);
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }

        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .knockout-grid {
                grid-template-columns: 1fr;
            }
            .header {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Ù…ÙˆØ¯Ø§Ù„ ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ± -->
    <div class="modal-overlay" id="loginModal">
        <div class="login-modal">
            <h2><i class="fas fa-lock"></i> Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</h2>
            <input type="password" id="adminPassword" class="login-input" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ù…Ø¯ÛŒØ±" maxlength="4" inputmode="numeric" pattern="[0-9]*">
            <button class="login-btn" onclick="checkAdminLogin()">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù¾Ù†Ù„</button>
            <div id="loginError" class="login-error"></div>
            <div style="margin-top: 20px; color: #9ca3af; font-size: 0.9rem;">
                <i class="fas fa-info-circle"></i> Ø±Ù…Ø² Ù¾ÛŒØ´â€ŒÙØ±Ø¶: 1234
            </div>
        </div>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ ØªØºÛŒÛŒØ± Ø±Ù…Ø² -->
    <div class="change-password-modal" id="changePasswordModal">
        <span class="close-modal" onclick="closeChangePasswordModal()">&times;</span>
        <h2 style="color: #fbbf24; margin-bottom: 30px;"><i class="fas fa-key"></i> ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ù…Ø¯ÛŒØ±</h2>
        
        <div style="margin-bottom: 20px;">
            <label style="color: #fbbf24; display: block; margin-bottom: 10px;">Ú©Ø¯ Ø§Ù…Ù†ÛŒØªÛŒ</label>
            <input type="password" id="securityCode" class="login-input" placeholder="Ú©Ø¯ Ø§Ù…Ù†ÛŒØªÛŒ 0887439" maxlength="7">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="color: #fbbf24; display: block; margin-bottom: 10px;">Ø±Ù…Ø² Ø¬Ø¯ÛŒØ¯ (Û´ Ø±Ù‚Ù…)</label>
            <input type="password" id="newPassword" class="login-input" placeholder="Ø±Ù…Ø² Ø¬Ø¯ÛŒØ¯ Û´ Ø±Ù‚Ù…ÛŒ" maxlength="4" inputmode="numeric" pattern="[0-9]*">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="color: #fbbf24; display: block; margin-bottom: 10px;">ØªÚ©Ø±Ø§Ø± Ø±Ù…Ø² Ø¬Ø¯ÛŒØ¯</label>
            <input type="password" id="confirmPassword" class="login-input" placeholder="ØªÚ©Ø±Ø§Ø± Ø±Ù…Ø² Ø¬Ø¯ÛŒØ¯" maxlength="4" inputmode="numeric" pattern="[0-9]*">
        </div>
        
        <button class="login-btn" onclick="changeAdminPassword()">ØªØºÛŒÛŒØ± Ø±Ù…Ø²</button>
        <div id="passwordChangeError" class="login-error" style="margin-top: 15px;"></div>
    </div>

    <div class="container" id="tournament-root">
        <!-- Ù‡Ø¯Ø± Ø¨Ø§ Ø¯Ú©Ù…Ù‡ ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ± -->
        <div class="header">
            <div>
                <span class="header-title">
                    <i class="fas fa-trophy"></i>
                    Ù„ÛŒÚ¯ Ù‚Ù‡Ø±Ù…Ø§Ù†Ø§Ù† Ø§Ø±ÙˆÙ¾Ø§
                </span>
            </div>
            <div>
                <button class="admin-login-btn" onclick="openLoginModal()" id="loginButton">
                    <i class="fas fa-user-shield"></i> ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ±
                </button>
            </div>
        </div>

        <!-- Ù†ÙˆØ§Ø± Ù…Ø¯ÛŒØ±ÛŒØª (ÙÙ‚Ø· Ø¨Ø¹Ø¯ Ø§Ø² ÙˆØ±ÙˆØ¯ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯) -->
        <div class="admin-bar" id="adminBar">
            <div class="admin-badge">
                <i class="fas fa-crown"></i> Ø­Ø§Ù„Øª Ù…Ø¯ÛŒØ±ÛŒØª ÙØ¹Ø§Ù„
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="admin-btn" onclick="openChangePasswordModal()">
                    <i class="fas fa-key"></i> ØªØºÛŒÛŒØ± Ø±Ù…Ø²
                </button>
                <button class="admin-btn" onclick="logoutAdmin()">
                    <i class="fas fa-sign-out-alt"></i> Ø®Ø±ÙˆØ¬
                </button>
            </div>
        </div>

        <!-- Ø§Ø¹Ù„Ø§Ù† Ø­Ø§Ù„Øª Ù†Ù…Ø§ÛŒØ´ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø¹Ø§Ø¯ÛŒ -->
        <div id="readOnlyNotice" style="text-align: center; margin-bottom: 20px; display: block;">
            <span class="edit-notice">
                <i class="fas fa-eye"></i> Ø­Ø§Ù„Øª Ù†Ù…Ø§ÛŒØ´ - Ø¨Ø±Ø§ÛŒ ÙˆÛŒØ±Ø§ÛŒØ´ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯
            </span>
        </div>

        <!-- ØªÙˆØ¶ÛŒØ­Ø§Øª Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨ -->
        <div class="github-note">
            <div style="display: flex; align-items: center; gap: 15px;">
                <i class="fab fa-github"></i>
                <span>Ø§ÛŒÙ† Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø±ÙˆÛŒ Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨ Pages Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ù…Ø§ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ Ø¨Ø§ Ø¨Ø³ØªÙ† ØµÙØ­Ù‡ Ù¾Ø§Ú© Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯.</span>
            </div>
            <a href="#" class="github-btn" onclick="exportToFile()">
                <i class="fas fa-download"></i> Ø°Ø®ÛŒØ±Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†
            </a>
        </div>

        <!-- Ø¢Ù…Ø§Ø± -->
        <div class="stats-grid" id="stats-container">
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-users"></i></div>
                <div class="stat-value" id="stat-teams">Û±Û´</div>
                <div>ØªÛŒÙ…â€ŒÙ‡Ø§</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-futbol"></i></div>
                <div class="stat-value" id="stat-matches">Û°</div>
                <div>Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ú¯Ø±ÙˆÙ‡ÛŒ</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-bullseye"></i></div>
                <div class="stat-value" id="stat-goals">Û°</div>
                <div>Ú©Ù„ Ú¯Ù„â€ŒÙ‡Ø§</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
                <div class="stat-value" id="stat-avg">Û°</div>
                <div>Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ú¯Ù„</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
                <div class="stat-value" id="stat-completed">Û°</div>
                <div>ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡</div>
            </div>
        </div>

        <!-- Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ -->
        <div class="groups-row editable" id="groups-container"></div>

        <!-- Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ú¯Ø±ÙˆÙ‡ÛŒ Ø¨Ø§ Ú©Ø§Ø¯Ø± ØªÙˆØ¶ÛŒØ­Ø§Øª -->
        <div class="matches-panel">
            <div class="panel-header">
                <h2 style="color: #fbbf24;"><i class="fas fa-futbol"></i> Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù…Ø³Ø§Ø¨Ù‚Ø§Øª</h2>
                <div class="match-tabs" id="match-tabs"></div>
            </div>
            <div id="matches-container" class="sortable-matches editable"></div>
        </div>

        <!-- Ø¨Ø®Ø´ ØªÛŒÙ…â€ŒÙ‡Ø§ Ùˆ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† -->
        <div class="teams-section editable" id="teams-section">
            <div class="section-title">
                <i class="fas fa-users"></i>
                <h2>ØªÛŒÙ…â€ŒÙ‡Ø§ Ùˆ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù†</h2>
            </div>
            <div id="teams-players-container" class="teams-grid"></div>
        </div>

        <!-- Ø¨Ø®Ø´ ØªÙˆØ¶ÛŒØ­Ø§Øª Ú©Ù„ÛŒ -->
        <div class="description-section editable" id="description-section">
            <div class="description-header">
                <i class="fas fa-file-alt"></i>
                <h2>ØªÙˆØ¶ÛŒØ­Ø§Øª Ùˆ Ù‚ÙˆØ§Ù†ÛŒÙ† Ù…Ø³Ø§Ø¨Ù‚Ø§Øª</h2>
            </div>
            <div class="description-content">
                <div id="description-view" class="description-view" style="display: none;"></div>
                <textarea id="description-editor" class="description-text" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø³Ø§Ø¨Ù‚Ø§ØªØŒ Ù‚ÙˆØ§Ù†ÛŒÙ†ØŒ Ø¬ÙˆØ§ÛŒØ² Ùˆ ..."></textarea>
            </div>
        </div>

        <!-- Ù…Ø±Ø­Ù„Ù‡ Ø­Ø°ÙÛŒ -->
        <div class="knockout-panel">
            <h2 style="color: #fbbf24; margin-bottom: 20px;"><i class="fas fa-crown"></i> Ù…Ø±Ø­Ù„Ù‡ Ø­Ø°ÙÛŒ</h2>
            <div id="knockout-container" class="knockout-grid editable"></div>
        </div>

        <!-- Ù†ÙˆØ§Ø± Ø§Ø¨Ø²Ø§Ø± -->
        <div class="toolbar editable" id="toolbar">
            <button class="btn" onclick="refreshAll()"><i class="fas fa-sync-alt"></i> Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ</button>
            <button class="btn" onclick="exportToPDF()"><i class="fas fa-file-pdf"></i> PDF</button>
            <button class="btn" onclick="exportToExcel()"><i class="fas fa-file-excel"></i> Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„</button>
            <button class="btn btn-outline" onclick="importFromExcel()"><i class="fas fa-upload"></i> ÙˆØ±ÙˆØ¯ÛŒ Ø§Ú©Ø³Ù„</button>
            <button class="btn btn-outline" onclick="simulateMatches()"><i class="fas fa-dice"></i> Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ</button>
            <button class="btn btn-outline" onclick="resetData()"><i class="fas fa-undo"></i> Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ</button>
        </div>

        <div style="display: flex; justify-content: center; gap: 15px; margin: 20px 0;">
            <span class="auto-save-badge">
                <i class="fas fa-save"></i> Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø±
                <span class="save-indicator"></span>
            </span>
            <span class="auto-save-badge" style="background: #3b82f6;">
                <i class="fas fa-history"></i> Ø¢Ø®Ø±ÛŒÙ† Ø°Ø®ÛŒØ±Ù‡: <span id="last-save">Ù„Ø­Ø¸Ø§ØªÛŒ Ù¾ÛŒØ´</span>
            </span>
        </div>

        <input type="file" id="excel-upload" accept=".xlsx, .xls, .csv" style="display: none;">
        <input type="file" id="json-upload" accept=".json" style="display: none;">
    </div>

    <script>
        // ==================== Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø³Ø±Ø§Ø³Ø±ÛŒ ====================
        let isAdmin = false;
        let adminPassword = "1234";
        const SECURITY_CODE = "0887439";
        let description = "ğŸ“‹ Ù‚ÙˆØ§Ù†ÛŒÙ† Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ù„ÛŒÚ¯ Ù‚Ù‡Ø±Ù…Ø§Ù†Ø§Ù† Ø§Ø±ÙˆÙ¾Ø§:\n\nâ€¢ Ù‡Ø± ØªÛŒÙ… Û³ Ø§Ù…ØªÛŒØ§Ø² Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø¯ØŒ Û± Ø§Ù…ØªÛŒØ§Ø² Ø¨Ø±Ø§ÛŒ Ù…Ø³Ø§ÙˆÛŒ\nâ€¢ Ø¯Ø± ØµÙˆØ±Øª ØªØ³Ø§ÙˆÛŒ Ø§Ù…ØªÛŒØ§Ø²ØŒ ØªÙØ§Ø¶Ù„ Ú¯Ù„ Ù…Ù„Ø§Ú© Ø§Ø³Øª\nâ€¢ Û² ØªÛŒÙ… Ø§ÙˆÙ„ Ù‡Ø± Ú¯Ø±ÙˆÙ‡ Ø¨Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Û² ØªÛŒÙ… Ø³ÙˆÙ… Ø¨Ø±ØªØ± Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ Ø­Ø°ÙÛŒ ØµØ¹ÙˆØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯\nâ€¢ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø­Ù„Ù‡ Ø­Ø°ÙÛŒ Ø¨Ù‡ ØµÙˆØ±Øª ØªÚ© Ø­Ø°ÙÛŒ Ø¨Ø±Ú¯Ø²Ø§Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯\nâ€¢ Ø¯Ø± ØµÙˆØ±Øª ØªØ³Ø§ÙˆÛŒ Ø¯Ø± ÙˆÙ‚Øª Ù‚Ø§Ù†ÙˆÙ†ÛŒØŒ ÙˆÙ‚Øª Ø§Ø¶Ø§ÙÙ‡ Ùˆ Ù¾Ù†Ø§Ù„ØªÛŒ";

        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        const defaultGroups = [
            ['Ø±Ø¦Ø§Ù„ Ù…Ø§Ø¯Ø±ÛŒØ¯', 'Ø¨Ø§ÛŒØ±Ù† Ù…ÙˆÙ†ÛŒØ®', 'Ù„ÛŒÙˆØ±Ù¾ÙˆÙ„', 'Ù¾Ø§Ø±ÛŒ Ø³Ù† Ú˜Ø±Ù…Ù†', 'Ø§ÛŒÙ†ØªØ± Ù…ÛŒÙ„Ø§Ù†'],
            ['Ù…Ù†Ú†Ø³ØªØ± Ø³ÛŒØªÛŒ', 'Ø¨Ø§Ø±Ø³Ù„ÙˆÙ†Ø§', 'Ø¢Ø±Ø³Ù†Ø§Ù„', 'Ø¢Ø« Ù…ÛŒÙ„Ø§Ù†', 'Ø¯ÙˆØ±ØªÙ…ÙˆÙ†Ø¯'],
            ['Ú†Ù„Ø³ÛŒ', 'Ù…Ù†Ú†Ø³ØªØ± ÛŒÙˆÙ†Ø§ÛŒØªØ¯', 'ÛŒÙˆÙˆÙ†ØªÙˆØ³', 'Ø§ØªÙ„ØªÛŒÚ©Ùˆ Ù…Ø§Ø¯Ø±ÛŒØ¯']
        ];

        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† Ùˆ Ø³Ø±Ù¾Ø±Ø³ØªØ§Ù†
        let playersData = {};
        let teamManagers = {};

        // Ù…ØªØºÛŒØ± Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù…ÙˆÙ‚Øª ØªÙˆØ¶ÛŒØ­Ø§Øª Ù‚Ø¨Ù„ Ø§Ø² Ø°Ø®ÛŒØ±Ù‡ Ù†Ù‡Ø§ÛŒÛŒ
        let tempNote = {};

        // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† Ùˆ Ø³Ø±Ù¾Ø±Ø³ØªØ§Ù†
        function initPlayersData() {
            const allTeams = defaultGroups.flat();
            allTeams.forEach(team => {
                if (!playersData[team]) {
                    playersData[team] = [
                        { name: 'Ø¨Ø§Ø²ÛŒÚ©Ù† Û±', goals: 0, yellow: 0, red: 0 },
                        { name: 'Ø¨Ø§Ø²ÛŒÚ©Ù† Û²', goals: 0, yellow: 0, red: 0 },
                        { name: 'Ø¨Ø§Ø²ÛŒÚ©Ù† Û³', goals: 0, yellow: 0, red: 0 }
                    ];
                }
                if (!teamManagers[team]) {
                    teamManagers[team] = 'Ø³Ø±Ù¾Ø±Ø³Øª ØªÛŒÙ…';
                }
            });
        }
        initPlayersData();

        let groups = [];
        let matches = [];
        let knockoutMatches = [];

        // ==================== ØªÙˆØ§Ø¨Ø¹ Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª ====================
        function openLoginModal() {
            document.getElementById('loginModal').classList.add('active');
            document.getElementById('adminPassword').value = '';
            document.getElementById('loginError').innerText = '';
        }

        function checkAdminLogin() {
            const entered = document.getElementById('adminPassword').value;
            if (entered === adminPassword) {
                isAdmin = true;
                document.getElementById('loginModal').classList.remove('active');
                document.getElementById('adminBar').classList.add('active');
                document.getElementById('readOnlyNotice').style.display = 'none';
                document.getElementById('loginButton').style.display = 'none';
                enableEditing(true);
                renderAll();
                autoSave();
            } else {
                document.getElementById('loginError').innerText = 'âŒ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª';
            }
        }

        function logoutAdmin() {
            isAdmin = false;
            document.getElementById('adminBar').classList.remove('active');
            document.getElementById('readOnlyNotice').style.display = 'block';
            document.getElementById('loginButton').style.display = 'inline-flex';
            enableEditing(false);
            renderAll();
        }

        function enableEditing(enable) {
            const editableElements = document.querySelectorAll('.editable');
            editableElements.forEach(el => {
                if (enable) {
                    el.classList.remove('disabled');
                } else {
                    el.classList.add('disabled');
                }
            });
            
            // Ù†Ù…Ø§ÛŒØ´/Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ÙˆÛŒØ±Ø§ÛŒØ´Ú¯Ø± ØªÙˆØ¶ÛŒØ­Ø§Øª Ú©Ù„ÛŒ
            const editor = document.getElementById('description-editor');
            const viewer = document.getElementById('description-view');
            
            if (editor && viewer) {
                if (enable) {
                    editor.style.display = 'block';
                    viewer.style.display = 'none';
                } else {
                    editor.style.display = 'none';
                    viewer.style.display = 'block';
                    viewer.innerText = description;
                }
            }
        }

        // ==================== ØªØºÛŒÛŒØ± Ø±Ù…Ø² ====================
        function openChangePasswordModal() {
            document.getElementById('changePasswordModal').classList.add('active');
        }

        function closeChangePasswordModal() {
            document.getElementById('changePasswordModal').classList.remove('active');
            document.getElementById('securityCode').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
            document.getElementById('passwordChangeError').innerText = '';
        }

        function changeAdminPassword() {
            const securityCode = document.getElementById('securityCode').value;
            const newPass = document.getElementById('newPassword').value;
            const confirmPass = document.getElementById('confirmPassword').value;

            if (securityCode !== SECURITY_CODE) {
                document.getElementById('passwordChangeError').innerText = 'âŒ Ú©Ø¯ Ø§Ù…Ù†ÛŒØªÛŒ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª';
                return;
            }

            if (!/^\d{4}$/.test(newPass)) {
                document.getElementById('passwordChangeError').innerText = 'âŒ Ø±Ù…Ø² Ø¨Ø§ÛŒØ¯ Û´ Ø±Ù‚Ù… Ø¨Ø§Ø´Ø¯';
                return;
            }

            if (newPass !== confirmPass) {
                document.getElementById('passwordChangeError').innerText = 'âŒ Ø±Ù…Ø²Ù‡Ø§ Ù…Ø·Ø§Ø¨Ù‚Øª Ù†Ø¯Ø§Ø±Ù†Ø¯';
                return;
            }

            adminPassword = newPass;
            alert('âœ… Ø±Ù…Ø² Ù…Ø¯ÛŒØ± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªØºÛŒÛŒØ± Ú©Ø±Ø¯');
            closeChangePasswordModal();
        }

        // ==================== ØªÙˆØ§Ø¨Ø¹ Ø°Ø®ÛŒØ±Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù† ====================
        window.exportToFile = function() {
            const data = {
                groups: groups,
                matches: matches,
                knockoutMatches: knockoutMatches,
                playersData: playersData,
                teamManagers: teamManagers,
                description: description,
                adminPassword: adminPassword,
                lastUpdated: new Date().toISOString()
            };

            const jsonData = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Ù„ÛŒÚ¯-Ù‚Ù‡Ø±Ù…Ø§Ù†Ø§Ù†-Ù¾Ø´ØªÛŒØ¨Ø§Ù†.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        };

        // ==================== Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø² localStorage ====================
        function loadFromStorage() {
            const saved = localStorage.getItem('championsLeagueData');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    groups = data.groups || JSON.parse(JSON.stringify(defaultGroups));
                    matches = data.matches || [];
                    knockoutMatches = data.knockoutMatches || getDefaultKnockout();
                    playersData = data.playersData || {};
                    teamManagers = data.teamManagers || {};
                    description = data.description || description;
                    
                    if (data.adminPassword) {
                        adminPassword = data.adminPassword;
                    }
                    
                    updateLastSaveTime();
                } catch (e) {
                    resetToDefault();
                }
            } else {
                resetToDefault();
            }
        }

        function getDefaultKnockout() {
            return [
                { id: 1, round: 'quarter', teams: ['', ''], score: [null, null] },
                { id: 2, round: 'quarter', teams: ['', ''], score: [null, null] },
                { id: 3, round: 'quarter', teams: ['', ''], score: [null, null] },
                { id: 4, round: 'quarter', teams: ['', ''], score: [null, null] },
                { id: 5, round: 'semi', teams: ['', ''], score: [null, null] },
                { id: 6, round: 'semi', teams: ['', ''], score: [null, null] },
                { id: 7, round: 'final', teams: ['', ''], score: [null, null] }
            ];
        }

        function resetToDefault() {
            groups = JSON.parse(JSON.stringify(defaultGroups));
            matches = [];
            initMatches();
            knockoutMatches = getDefaultKnockout();
            initPlayersData();
        }

        function initMatches() {
            matches = [];
            for (let g = 0; g < groups.length; g++) {
                const teamCount = groups[g].length;
                for (let i = 0; i < teamCount; i++) {
                    for (let j = i + 1; j < teamCount; j++) {
                        matches.push({
                            id: `m_${g}_${i}_${j}_${Date.now()}_${Math.random()}`,
                            groupIndex: g,
                            homeIndex: i,
                            awayIndex: j,
                            homeScore: null,
                            awayScore: null,
                            note: '',
                            order: matches.length
                        });
                    }
                }
            }
        }

        // ==================== Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ø¯Ø± localStorage ====================
        function autoSave() {
            const data = {
                groups: groups,
                matches: matches,
                knockoutMatches: knockoutMatches,
                playersData: playersData,
                teamManagers: teamManagers,
                description: description,
                adminPassword: adminPassword,
                lastUpdated: new Date().toISOString()
            };
            localStorage.setItem('championsLeagueData', JSON.stringify(data));
            updateLastSaveTime();
        }

        function updateLastSaveTime() {
            const now = new Date();
            document.getElementById('last-save').textContent = 
                `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
        }

        // ==================== Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¢Ù…Ø§Ø±ÛŒ ====================
        function calculateAllStats() {
            let totalGoals = 0;
            let playedMatches = 0;
            
            matches.forEach(m => {
                if (m.homeScore !== null && m.awayScore !== null) {
                    totalGoals += m.homeScore + m.awayScore;
                    playedMatches++;
                }
            });

            document.getElementById('stat-teams').textContent = 'Û±Û´';
            document.getElementById('stat-matches').textContent = playedMatches + '/' + matches.length;
            document.getElementById('stat-goals').textContent = totalGoals;
            document.getElementById('stat-avg').textContent = playedMatches ? (totalGoals / playedMatches).toFixed(2) : 'Û°';
            document.getElementById('stat-completed').textContent = 
                Math.round((playedMatches / matches.length) * 100) + '%';
        }

        function getStandings() {
            const standings = [];
            for (let g = 0; g < groups.length; g++) {
                const teamCount = groups[g].length;
                const points = Array(teamCount).fill(0);
                const gf = Array(teamCount).fill(0);
                const ga = Array(teamCount).fill(0);
                const played = Array(teamCount).fill(0);

                matches.filter(m => m.groupIndex === g).forEach(m => {
                    if (m.homeScore !== null && m.awayScore !== null) {
                        played[m.homeIndex]++;
                        played[m.awayIndex]++;
                        gf[m.homeIndex] += m.homeScore;
                        ga[m.homeIndex] += m.awayScore;
                        gf[m.awayIndex] += m.awayScore;
                        ga[m.awayIndex] += m.homeScore;

                        if (m.homeScore > m.awayScore) points[m.homeIndex] += 3;
                        else if (m.homeScore < m.awayScore) points[m.awayIndex] += 3;
                        else {
                            points[m.homeIndex] += 1;
                            points[m.awayIndex] += 1;
                        }
                    }
                });

                const teamList = [];
                for (let i = 0; i < teamCount; i++) {
                    teamList.push({
                        index: i,
                        name: groups[g][i],
                        points: points[i],
                        played: played[i],
                        gf: gf[i],
                        ga: ga[i],
                        gd: gf[i] - ga[i]
                    });
                }
                teamList.sort((a, b) => {
                    if (a.points !== b.points) return b.points - a.points;
                    if (a.gd !== b.gd) return b.gd - a.gd;
                    return b.gf - a.gf;
                });
                standings[g] = teamList;
            }
            return standings;
        }

        // ==================== Ø±Ù†Ø¯Ø± Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ ====================
        function renderGroups() {
            const standings = getStandings();
            const container = document.getElementById('groups-container');
            let html = '';

            ['A', 'B', 'C'].forEach((letter, g) => {
                html += `<div class="group-card"><div class="group-header"><span class="group-title">Ú¯Ø±ÙˆÙ‡ ${letter}</span><span>${groups[g].length} ØªÛŒÙ…</span></div>`;
                
                standings[g].forEach((team, idx) => {
                    html += `
                        <div class="team-row">
                            <span class="rank">${idx + 1}</span>
                            <input type="text" class="team-input" value="${team.name}" data-group="${g}" data-index="${team.index}" ${!isAdmin ? 'disabled' : ''}>
                            <div class="team-stats">
                                <div class="stat"><span class="stat-num">${team.points}</span><br>Ø§Ù…ØªÛŒØ§Ø²</div>
                                <div class="stat"><span class="stat-num">${team.gf}</span><br>Ú¯Ù„ Ø²Ø¯Ù‡</div>
                                <div class="stat"><span class="stat-num">${team.gd}</span><br>ØªÙØ§Ø¶Ù„</div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            });

            container.innerHTML = html;

            if (isAdmin) {
                document.querySelectorAll('.team-input').forEach(inp => {
                    inp.removeEventListener('change', handleTeamChange);
                    inp.addEventListener('change', handleTeamChange);
                });
            }
        }

        function handleTeamChange(e) {
            const g = parseInt(e.target.dataset.group);
            const idx = parseInt(e.target.dataset.index);
            const oldName = groups[g][idx];
            const newName = e.target.value || '???';
            
            if (oldName !== newName) {
                if (playersData[oldName]) {
                    playersData[newName] = playersData[oldName];
                    delete playersData[oldName];
                }
                if (teamManagers[oldName]) {
                    teamManagers[newName] = teamManagers[oldName];
                    delete teamManagers[oldName];
                }
            }
            
            groups[g][idx] = newName;
            autoSave();
            renderAll();
        }

        // ==================== Ø±Ù†Ø¯Ø± Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø¨Ø§ Ú©Ø§Ø¯Ø± ØªÙˆØ¶ÛŒØ­Ø§Øª ====================
        function renderTabs(active = 0) {
            const tabs = document.getElementById('match-tabs');
            let html = '';
            ['A', 'B', 'C'].forEach((letter, g) => {
                const groupMatches = matches.filter(m => m.groupIndex === g);
                const played = groupMatches.filter(m => m.homeScore !== null).length;
                html += `<button class="tab-btn ${g === active ? 'active' : ''}" onclick="switchTab(${g})">Ú¯Ø±ÙˆÙ‡ ${letter} (${played}/${groupMatches.length})</button>`;
            });
            tabs.innerHTML = html;
        }

        function renderMatches(activeGroup = 0) {
            const container = document.getElementById('matches-container');
            const groupMatches = matches.filter(m => m.groupIndex === activeGroup);
            groupMatches.sort((a, b) => (a.order || 0) - (b.order || 0));

            let html = '';
            groupMatches.forEach(m => {
                const homeName = groups[activeGroup][m.homeIndex];
                const awayName = groups[activeGroup][m.awayIndex];

                // Ù…Ù‚Ø¯Ø§Ø± Ù…ÙˆÙ‚Øª Ø¨Ø±Ø§ÛŒ ØªÙˆØ¶ÛŒØ­Ø§Øª
                const tempNoteValue = tempNote[`${m.id}`] !== undefined ? tempNote[`${m.id}`] : m.note;

                html += `
                    <div class="match-item" data-match-id="${m.id}">
                        <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                            ${isAdmin ? '<span class="drag-handle"><i class="fas fa-grip-lines"></i></span>' : ''}
                            <div class="match-teams">
                                <span class="team-badge">${homeName}</span>
                                <span class="vs">VS</span>
                                <span class="team-badge">${awayName}</span>
                            </div>
                        </div>
                        <div class="match-info">
                            ${isAdmin ? `
                                <!-- Ø­Ø§Ù„Øª ÙˆÛŒØ±Ø§ÛŒØ´ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ± -->
                                <div class="note-card">
                                    <div class="note-icon">
                                        <i class="fas fa-pen"></i>
                                    </div>
                                    <input type="text" class="note-input" id="note-${m.id}" value="${tempNoteValue}" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ø¨Ø§Ø²ÛŒ ...">
                                    <button class="save-note-btn" onclick="saveNote('${m.id}')" title="Ø°Ø®ÛŒØ±Ù‡ ØªÙˆØ¶ÛŒØ­Ø§Øª">
                                        <i class="fas fa-check"></i>
                                    </button>
                                </div>
                            ` : m.note ? `
                                <!-- Ø­Ø§Ù„Øª Ù†Ù…Ø§ÛŒØ´ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø¹Ø§Ø¯ÛŒ (Ø§Ú¯Ø± ØªÙˆØ¶ÛŒØ­Ø§Øª ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯) -->
                                <div class="note-display" title="${m.note}">
                                    <i class="fas fa-pen"></i>
                                    <span>${m.note}</span>
                                </div>
                            ` : ''}
                            <div class="score-inputs">
                                <input type="number" min="0" class="score-inp home-score" data-match-id="${m.id}" value="${m.homeScore !== null ? m.homeScore : ''}" ${!isAdmin ? 'disabled' : ''} placeholder="-">
                                <span>-</span>
                                <input type="number" min="0" class="score-inp away-score" data-match-id="${m.id}" value="${m.awayScore !== null ? m.awayScore : ''}" ${!isAdmin ? 'disabled' : ''} placeholder="-">
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;

            if (isAdmin) {
                // Sortable
                new Sortable(container, {
                    animation: 150,
                    handle: '.drag-handle',
                    onEnd: function(evt) {
                        const items = [...container.children];
                        items.forEach((item, index) => {
                            const matchId = item.dataset.matchId;
                            const match = matches.find(m => m.id === matchId);
                            if (match) match.order = index;
                        });
                        autoSave();
                    }
                });

                document.querySelectorAll('.score-inp').forEach(inp => {
                    inp.addEventListener('change', handleScoreChange);
                });

                document.querySelectorAll('.note-input').forEach(inp => {
                    inp.addEventListener('input', function(e) {
                        const matchId = this.id.replace('note-', '');
                        tempNote[matchId] = this.value;
                    });
                });
            }
        }

        // ØªØ§Ø¨Ø¹ Ø°Ø®ÛŒØ±Ù‡ ØªÙˆØ¶ÛŒØ­Ø§Øª
        window.saveNote = function(matchId) {
            if (!isAdmin) return;
            
            const match = matches.find(m => m.id === matchId);
            if (match) {
                if (tempNote[matchId] !== undefined) {
                    match.note = tempNote[matchId];
                }
                
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù…Ù‚Ø¯Ø§Ø± Ù…ÙˆÙ‚Øª
                delete tempNote[matchId];
                
                autoSave();
                
                // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ú©ÙˆØªØ§Ù‡
                const btn = event.target.closest('.save-note-btn');
                const originalHtml = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check" style="color:#fff;"></i>';
                btn.style.background = '#10b981';
                setTimeout(() => {
                    btn.innerHTML = originalHtml;
                }, 1000);
            }
        };

        function handleScoreChange(e) {
            const matchId = e.target.dataset.matchId;
            const match = matches.find(m => m.id === matchId);
            if (!match) return;

            const isHome = e.target.classList.contains('home-score');
            const val = e.target.value === '' ? null : parseInt(e.target.value);

            if (val !== null && (isNaN(val) || val < 0)) {
                alert('Ø¹Ø¯Ø¯ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                e.target.value = '';
                return;
            }

            if (isHome) match.homeScore = val;
            else match.awayScore = val;

            autoSave();
            renderAll();
        }

        // ==================== Ø±Ù†Ø¯Ø± ØªÛŒÙ…â€ŒÙ‡Ø§ Ùˆ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† ====================
        function renderTeamsAndPlayers() {
            const container = document.getElementById('teams-players-container');
            const allTeams = groups.flat().filter(t => t && t.trim() !== '');
            
            let html = '';
            allTeams.forEach(team => {
                if (!playersData[team]) {
                    playersData[team] = [
                        { name: 'Ø¨Ø§Ø²ÛŒÚ©Ù† Û±', goals: 0, yellow: 0, red: 0 },
                        { name: 'Ø¨Ø§Ø²ÛŒÚ©Ù† Û²', goals: 0, yellow: 0, red: 0 },
                        { name: 'Ø¨Ø§Ø²ÛŒÚ©Ù† Û³', goals: 0, yellow: 0, red: 0 }
                    ];
                }
                if (!teamManagers[team]) {
                    teamManagers[team] = 'Ø³Ø±Ù¾Ø±Ø³Øª ØªÛŒÙ…';
                }

                const players = playersData[team];
                
                html += `
                    <div class="team-card">
                        <div class="team-header">
                            <span>${team}</span>
                        </div>
                        
                        <!-- Ú©Ø§Ø¯Ø± Ø³Ø±Ù¾Ø±Ø³Øª ØªÛŒÙ… -->
                        <div class="team-manager">
                            <span class="manager-label"><i class="fas fa-user-tie"></i> Ø³Ø±Ù¾Ø±Ø³Øª:</span>
                            ${isAdmin ? 
                                `<input type="text" class="manager-input" value="${teamManagers[team]}" data-team="${team}" placeholder="Ù†Ø§Ù… Ø³Ø±Ù¾Ø±Ø³Øª">` : 
                                `<span class="view-only">${teamManagers[team]}</span>`
                            }
                        </div>

                        <div class="players-panel">
                            <div class="players-stats-header">
                                <span style="flex:2;">Ù†Ø§Ù… Ø¨Ø§Ø²ÛŒÚ©Ù†</span>
                                <span style="width:180px; display:flex; gap:5px; justify-content:center;">
                                    <span style="width:60px;"><i class="fas fa-futbol goal"></i> Ú¯Ù„</span>
                                    <span style="width:60px;"><i class="fas fa-square yellow"></i> Ø²Ø±Ø¯</span>
                                    <span style="width:60px;"><i class="fas fa-square red"></i> Ù‚Ø±Ù…Ø²</span>
                                </span>
                            </div>
                `;

                players.forEach((player, index) => {
                    html += `
                        <div class="player-row">
                            ${isAdmin ? 
                                `<input type="text" class="player-name-input" value="${player.name}" data-team="${team}" data-index="${index}" data-field="name">` : 
                                `<span class="view-only" style="flex:2; min-width:120px;">${player.name}</span>`
                            }
                            <div class="stats-container">
                                <!-- Ú©Ù†ØªØ±Ù„ Ú¯Ù„ -->
                                <div class="stat-control goal">
                                    ${isAdmin ? `<button class="stat-control-btn minus" onclick="adjustStat('${team.replace(/'/g, "\\'")}', ${index}, 'goals', -1)">âˆ’</button>` : ''}
                                    <span class="stat-value-display" id="stat-${team.replace(/\s/g, '')}-${index}-goals">${player.goals}</span>
                                    ${isAdmin ? `<button class="stat-control-btn plus" onclick="adjustStat('${team.replace(/'/g, "\\'")}', ${index}, 'goals', 1)">+</button>` : ''}
                                </div>
                                
                                <!-- Ú©Ù†ØªØ±Ù„ Ú©Ø§Ø±Øª Ø²Ø±Ø¯ -->
                                <div class="stat-control yellow">
                                    ${isAdmin ? `<button class="stat-control-btn minus" onclick="adjustStat('${team.replace(/'/g, "\\'")}', ${index}, 'yellow', -1)">âˆ’</button>` : ''}
                                    <span class="stat-value-display" id="stat-${team.replace(/\s/g, '')}-${index}-yellow">${player.yellow}</span>
                                    ${isAdmin ? `<button class="stat-control-btn plus" onclick="adjustStat('${team.replace(/'/g, "\\'")}', ${index}, 'yellow', 1)">+</button>` : ''}
                                </div>
                                
                                <!-- Ú©Ù†ØªØ±Ù„ Ú©Ø§Ø±Øª Ù‚Ø±Ù…Ø² -->
                                <div class="stat-control red">
                                    ${isAdmin ? `<button class="stat-control-btn minus" onclick="adjustStat('${team.replace(/'/g, "\\'")}', ${index}, 'red', -1)">âˆ’</button>` : ''}
                                    <span class="stat-value-display" id="stat-${team.replace(/\s/g, '')}-${index}-red">${player.red}</span>
                                    ${isAdmin ? `<button class="stat-control-btn plus" onclick="adjustStat('${team.replace(/'/g, "\\'")}', ${index}, 'red', 1)">+</button>` : ''}
                                </div>
                            </div>
                            ${isAdmin ? `<i class="fas fa-trash delete-player" onclick="deletePlayer('${team.replace(/'/g, "\\'")}', ${index})"></i>` : ''}
                        </div>
                    `;
                });

                if (isAdmin) {
                    html += `
                        <button class="add-player-btn" onclick="addPlayer('${team.replace(/'/g, "\\'")}')">
                            <i class="fas fa-plus"></i> Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¬Ø¯ÛŒØ¯
                        </button>
                    `;
                }

                html += '</div></div>';
            });

            container.innerHTML = html;

            if (isAdmin) {
                document.querySelectorAll('.player-name-input').forEach(inp => {
                    inp.addEventListener('change', handlePlayerNameChange);
                });

                document.querySelectorAll('.manager-input').forEach(inp => {
                    inp.addEventListener('change', function(e) {
                        const team = this.dataset.team;
                        teamManagers[team] = this.value;
                        autoSave();
                    });
                });
            }
        }

        // ØªØ§Ø¨Ø¹ ØªÙ†Ø¸ÛŒÙ… Ø¢Ù…Ø§Ø± Ø¨Ø§ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ + Ùˆ -
        window.adjustStat = function(team, index, field, delta) {
            if (!isAdmin) return;
            
            if (playersData[team] && playersData[team][index]) {
                const currentValue = playersData[team][index][field] || 0;
                const newValue = Math.max(0, currentValue + delta);
                playersData[team][index][field] = newValue;
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´
                const elementId = `stat-${team.replace(/\s/g, '')}-${index}-${field}`;
                const element = document.getElementById(elementId);
                if (element) {
                    element.textContent = newValue;
                }
                
                autoSave();
            }
        };

        function handlePlayerNameChange(e) {
            const team = e.target.dataset.team;
            const index = parseInt(e.target.dataset.index);
            const value = e.target.value;

            if (playersData[team] && playersData[team][index]) {
                playersData[team][index].name = value;
                autoSave();
            }
        }

        window.addPlayer = function(team) {
            if (!isAdmin) return;
            if (!playersData[team]) {
                playersData[team] = [];
            }
            playersData[team].push({ name: 'Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¬Ø¯ÛŒØ¯', goals: 0, yellow: 0, red: 0 });
            autoSave();
            renderTeamsAndPlayers();
        };

        window.deletePlayer = function(team, index) {
            if (!isAdmin) return;
            if (playersData[team]) {
                playersData[team].splice(index, 1);
                autoSave();
                renderTeamsAndPlayers();
            }
        };

        // ==================== Ø±Ù†Ø¯Ø± Ù…Ø±Ø­Ù„Ù‡ Ø­Ø°ÙÛŒ ====================
        function renderKnockout() {
            const container = document.getElementById('knockout-container');
            const allTeams = groups.flat().filter(t => t && t.trim() !== '');

            const quarters = knockoutMatches.filter(m => m.round === 'quarter');
            const semis = knockoutMatches.filter(m => m.round === 'semi');
            const finals = knockoutMatches.filter(m => m.round === 'final');

            let html = '';

            // ÛŒÚ©â€ŒÚ†Ù‡Ø§Ø±Ù…
            html += '<div class="round-box"><div class="round-title">ğŸ”¹ ÛŒÚ©â€ŒÚ†Ù‡Ø§Ø±Ù… Ù†Ù‡Ø§ÛŒÛŒ</div>';
            quarters.forEach(m => {
                html += renderKnockoutMatch(m, allTeams);
            });
            if (isAdmin) {
                html += '<button class="btn btn-outline" style="width:100%; margin-top:10px;" onclick="addMatch(\'quarter\')"><i class="fas fa-plus"></i> Ø§Ø¶Ø§ÙÙ‡ Ø¨Ø§Ø²ÛŒ</button>';
            }
            html += '</div>';

            // Ù†ÛŒÙ…Ù‡ Ù†Ù‡Ø§ÛŒÛŒ
            html += '<div class="round-box"><div class="round-title">ğŸ”¸ Ù†ÛŒÙ…Ù‡ Ù†Ù‡Ø§ÛŒÛŒ</div>';
            semis.forEach(m => {
                html += renderKnockoutMatch(m, allTeams);
            });
            if (isAdmin) {
                html += '<button class="btn btn-outline" style="width:100%; margin-top:10px;" onclick="addMatch(\'semi\')"><i class="fas fa-plus"></i> Ø§Ø¶Ø§ÙÙ‡ Ø¨Ø§Ø²ÛŒ</button>';
            }
            html += '</div>';

            // ÙÛŒÙ†Ø§Ù„
            html += '<div class="round-box"><div class="round-title">ğŸ† ÙÛŒÙ†Ø§Ù„</div>';
            finals.forEach(m => {
                html += renderKnockoutMatch(m, allTeams);
            });
            if (isAdmin) {
                html += '<button class="btn btn-outline" style="width:100%; margin-top:10px;" onclick="addMatch(\'final\')"><i class="fas fa-plus"></i> Ø§Ø¶Ø§ÙÙ‡ Ø¨Ø§Ø²ÛŒ</button>';
            }
            html += '</div>';

            container.innerHTML = html;

            if (isAdmin) {
                document.querySelectorAll('.team-select').forEach(select => {
                    select.addEventListener('change', handleKnockoutTeamChange);
                });

                document.querySelectorAll('.knockout-score').forEach(inp => {
                    inp.addEventListener('change', handleKnockoutScoreChange);
                });

                document.querySelectorAll('.delete-match').forEach(btn => {
                    btn.addEventListener('click', handleDeleteMatch);
                });
            }
        }

        function renderKnockoutMatch(match, allTeams) {
            return `
                <div class="knockout-match">
                    <select class="team-select" data-match-id="${match.id}" data-team-idx="0" ${!isAdmin ? 'disabled' : ''}>
                        <option value="">Ø§Ù†ØªØ®Ø§Ø¨ ØªÛŒÙ…</option>
                        ${allTeams.map(t => `<option value="${t}" ${match.teams[0] === t ? 'selected' : ''}>${t}</option>`).join('')}
                    </select>
                    <div style="text-align:center; margin:5px 0;">VS</div>
                    <select class="team-select" data-match-id="${match.id}" data-team-idx="1" ${!isAdmin ? 'disabled' : ''}>
                        <option value="">Ø§Ù†ØªØ®Ø§Ø¨ ØªÛŒÙ…</option>
                        ${allTeams.map(t => `<option value="${t}" ${match.teams[1] === t ? 'selected' : ''}>${t}</option>`).join('')}
                    </select>
                    <div style="display:flex; gap:10px; justify-content:center; margin-top:10px;">
                        <input type="number" min="0" class="score-inp knockout-score" style="width:60px;" data-match-id="${match.id}" data-team-idx="0" value="${match.score[0] !== null ? match.score[0] : ''}" ${!isAdmin ? 'disabled' : ''}>
                        <span style="color:#fbbf24;">-</span>
                        <input type="number" min="0" class="score-inp knockout-score" style="width:60px;" data-match-id="${match.id}" data-team-idx="1" value="${match.score[1] !== null ? match.score[1] : ''}" ${!isAdmin ? 'disabled' : ''}>
                    </div>
                    ${isAdmin ? '<i class="fas fa-trash delete-match" data-match-id="' + match.id + '" style="color:#ef4444; cursor:pointer; display:block; text-align:center; margin-top:8px;"></i>' : ''}
                </div>
            `;
        }

        function handleKnockoutTeamChange(e) {
            const matchId = parseInt(e.target.dataset.matchId);
            const teamIdx = parseInt(e.target.dataset.teamIdx);
            const match = knockoutMatches.find(m => m.id === matchId);
            if (match) {
                match.teams[teamIdx] = e.target.value;
                autoSave();
            }
        }

        function handleKnockoutScoreChange(e) {
            const matchId = parseInt(e.target.dataset.matchId);
            const teamIdx = parseInt(e.target.dataset.teamIdx);
            const match = knockoutMatches.find(m => m.id === matchId);
            if (match) {
                const val = e.target.value === '' ? null : parseInt(e.target.value);
                if (val !== null && (isNaN(val) || val < 0)) {
                    alert('Ø¹Ø¯Ø¯ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                    e.target.value = '';
                    return;
                }
                match.score[teamIdx] = val;
                autoSave();
            }
        }

        function handleDeleteMatch(e) {
            const matchId = parseInt(e.target.dataset.matchId);
            knockoutMatches = knockoutMatches.filter(m => m.id !== matchId);
            autoSave();
            renderAll();
        }

        // ==================== ØªÙˆØ§Ø¨Ø¹ Ø³Ø±Ø§Ø³Ø±ÛŒ ====================
        window.switchTab = function(groupIdx) {
            renderTabs(groupIdx);
            renderMatches(groupIdx);
        };

        window.addMatch = function(round) {
            if (!isAdmin) return;
            const newId = Math.max(...knockoutMatches.map(m => m.id), 0) + 1;
            knockoutMatches.push({ id: newId, round: round, teams: ['', ''], score: [null, null] });
            autoSave();
            renderKnockout();
        };

        window.refreshAll = function() {
            renderAll();
        };

        function renderAll() {
            renderGroups();
            renderTabs(0);
            renderMatches(0);
            renderTeamsAndPlayers();
            renderKnockout();
            calculateAllStats();
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¨Ø®Ø´ ØªÙˆØ¶ÛŒØ­Ø§Øª Ú©Ù„ÛŒ
            const editor = document.getElementById('description-editor');
            const viewer = document.getElementById('description-view');
            
            if (editor && viewer) {
                if (isAdmin) {
                    editor.style.display = 'block';
                    viewer.style.display = 'none';
                    editor.value = description;
                    
                    // Ø±ÙˆÛŒØ¯Ø§Ø¯ ØªØºÛŒÛŒØ± ØªÙˆØ¶ÛŒØ­Ø§Øª
                    editor.oninput = function() {
                        description = this.value;
                        autoSave();
                    };
                } else {
                    editor.style.display = 'none';
                    viewer.style.display = 'block';
                    viewer.innerText = description;
                }
            }
            
            enableEditing(isAdmin);
        }

        window.simulateMatches = function() {
            if (!isAdmin) {
                alert('âŒ ÙÙ‚Ø· Ù…Ø¯ÛŒØ± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ù†Ø¯');
                return;
            }
            matches.forEach(m => {
                m.homeScore = Math.floor(Math.random() * 5);
                m.awayScore = Math.floor(Math.random() * 5);
            });
            autoSave();
            renderAll();
        };

        window.resetData = function() {
            if (!isAdmin) {
                alert('âŒ ÙÙ‚Ø· Ù…Ø¯ÛŒØ± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ú©Ù†Ø¯');
                return;
            }
            if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ ØªÙ…Ø§Ù… ØªØºÛŒÛŒØ±Ø§Øª Ù¾Ø§Ú© Ù…ÛŒâ€ŒØ´ÙˆØ¯.')) {
                resetToDefault();
                autoSave();
                renderAll();
            }
        };

        window.exportToPDF = function() {
            const element = document.getElementById('tournament-root');
            
            html2canvas(element, {
                scale: 2,
                backgroundColor: '#0a0f1f',
                windowWidth: 1600
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jspdf.jsPDF({
                    orientation: 'landscape',
                    unit: 'px',
                    format: [canvas.width * 0.75, canvas.height * 0.75]
                });
                
                pdf.addImage(imgData, 'PNG', 0, 0, canvas.width * 0.75, canvas.height * 0.75);
                pdf.save('Ù„ÛŒÚ¯-Ù‚Ù‡Ø±Ù…Ø§Ù†Ø§Ù†-Ù…Ø¯ÛŒØ±ÛŒØª.pdf');
            });
        };

        window.exportToExcel = function() {
            const wb = XLSX.utils.book_new();
            
            // Ø¨Ø±Ú¯Ù‡ Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§
            const groupsData = [['Ú¯Ø±ÙˆÙ‡', 'Ø±ØªØ¨Ù‡', 'ØªÛŒÙ…', 'Ø§Ù…ØªÛŒØ§Ø²', 'Ú¯Ù„ Ø²Ø¯Ù‡', 'ØªÙØ§Ø¶Ù„']];
            const standings = getStandings();
            
            ['A', 'B', 'C'].forEach((letter, g) => {
                standings[g].forEach((team, idx) => {
                    groupsData.push([`Ú¯Ø±ÙˆÙ‡ ${letter}`, idx + 1, team.name, team.points, team.gf, team.gd]);
                });
                groupsData.push([]);
            });

            const wsGroups = XLSX.utils.aoa_to_sheet(groupsData);
            XLSX.utils.book_append_sheet(wb, wsGroups, 'Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§');

            // Ø¨Ø±Ú¯Ù‡ Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ú¯Ø±ÙˆÙ‡ÛŒ
            const matchesData = [['Ú¯Ø±ÙˆÙ‡', 'ØªÛŒÙ… Ù…ÛŒØ²Ø¨Ø§Ù†', 'ØªÛŒÙ… Ù…Ù‡Ù…Ø§Ù†', 'ØªÙˆØ¶ÛŒØ­Ø§Øª', 'Ù†ØªÛŒØ¬Ù‡ Ù…ÛŒØ²Ø¨Ø§Ù†', 'Ù†ØªÛŒØ¬Ù‡ Ù…Ù‡Ù…Ø§Ù†']];
            matches.forEach(m => {
                const group = ['A', 'B', 'C'][m.groupIndex];
                const home = groups[m.groupIndex][m.homeIndex];
                const away = groups[m.groupIndex][m.awayIndex];
                matchesData.push([
                    group,
                    home,
                    away,
                    m.note || '',
                    m.homeScore !== null ? m.homeScore : '',
                    m.awayScore !== null ? m.awayScore : ''
                ]);
            });

            const wsMatches = XLSX.utils.aoa_to_sheet(matchesData);
            XLSX.utils.book_append_sheet(wb, wsMatches, 'Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ú¯Ø±ÙˆÙ‡ÛŒ');

            // Ø¨Ø±Ú¯Ù‡ ØªÛŒÙ…â€ŒÙ‡Ø§ Ùˆ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù†
            const playersSheetData = [['ØªÛŒÙ…', 'Ø³Ø±Ù¾Ø±Ø³Øª', 'Ù†Ø§Ù… Ø¨Ø§Ø²ÛŒÚ©Ù†', 'Ú¯Ù„', 'Ú©Ø§Ø±Øª Ø²Ø±Ø¯', 'Ú©Ø§Ø±Øª Ù‚Ø±Ù…Ø²']];
            Object.keys(playersData).forEach(team => {
                const manager = teamManagers[team] || 'Ø³Ø±Ù¾Ø±Ø³Øª ØªÛŒÙ…';
                playersData[team].forEach(player => {
                    playersSheetData.push([team, manager, player.name, player.goals, player.yellow, player.red]);
                });
            });

            const wsPlayers = XLSX.utils.aoa_to_sheet(playersSheetData);
            XLSX.utils.book_append_sheet(wb, wsPlayers, 'Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù†');

            // Ø¨Ø±Ú¯Ù‡ Ù…Ø±Ø­Ù„Ù‡ Ø­Ø°ÙÛŒ
            const koData = [['Ù…Ø±Ø­Ù„Ù‡', 'ØªÛŒÙ… Û±', 'ØªÛŒÙ… Û²', 'Ú¯Ù„ ØªÛŒÙ… Û±', 'Ú¯Ù„ ØªÛŒÙ… Û²']];
            knockoutMatches.forEach(m => {
                const roundName = 
                    m.round === 'quarter' ? 'ÛŒÚ©â€ŒÚ†Ù‡Ø§Ø±Ù…' : 
                    m.round === 'semi' ? 'Ù†ÛŒÙ…Ù‡ Ù†Ù‡Ø§ÛŒÛŒ' : 'ÙÛŒÙ†Ø§Ù„';
                koData.push([
                    roundName,
                    m.teams[0] || '',
                    m.teams[1] || '',
                    m.score[0] !== null ? m.score[0] : '',
                    m.score[1] !== null ? m.score[1] : ''
                ]);
            });

            const wsKo = XLSX.utils.aoa_to_sheet(koData);
            XLSX.utils.book_append_sheet(wb, wsKo, 'Ù…Ø±Ø­Ù„Ù‡ Ø­Ø°ÙÛŒ');

            // Ø¨Ø±Ú¯Ù‡ ØªÙˆØ¶ÛŒØ­Ø§Øª Ú©Ù„ÛŒ
            const descData = [['ØªÙˆØ¶ÛŒØ­Ø§Øª'], [description]];
            const wsDesc = XLSX.utils.aoa_to_sheet(descData);
            XLSX.utils.book_append_sheet(wb, wsDesc, 'ØªÙˆØ¶ÛŒØ­Ø§Øª Ú©Ù„ÛŒ');

            XLSX.writeFile(wb, 'Ù„ÛŒÚ¯-Ù‚Ù‡Ø±Ù…Ø§Ù†Ø§Ù†.xlsx');
        };

        window.importFromExcel = function() {
            if (!isAdmin) {
                alert('âŒ ÙÙ‚Ø· Ù…Ø¯ÛŒØ± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ ÙˆØ§Ø±Ø¯ Ú©Ù†Ø¯');
                return;
            }
            document.getElementById('excel-upload').click();
        };

        // ==================== Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ====================
        loadFromStorage();
        renderAll();
        enableEditing(false);

        // Event listener Ø¨Ø±Ø§ÛŒ Ø¢Ù¾Ù„ÙˆØ¯ Ø§Ú©Ø³Ù„
        document.getElementById('excel-upload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(loadEvent) {
                const data = new Uint8Array(loadEvent.target.result);
                const workbook = XLSX.read(data, { type: 'array' });

                // Ø®ÙˆØ§Ù†Ø¯Ù† Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ú¯Ø±ÙˆÙ‡ÛŒ
                const matchesSheet = workbook.Sheets['Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ú¯Ø±ÙˆÙ‡ÛŒ'];
                if (matchesSheet) {
                    const matchesData = XLSX.utils.sheet_to_json(matchesSheet, { header: 1 });
                    matchesData.shift();
                    
                    matchesData.forEach((row, idx) => {
                        if (row.length >= 6 && matches[idx]) {
                            const groupLetter = row[0];
                            const groupIndex = groupLetter === 'A' ? 0 : groupLetter === 'B' ? 1 : 2;
                            if (matches[idx].groupIndex === groupIndex) {
                                matches[idx].note = row[3] || '';
                                matches[idx].homeScore = row[4] !== '' ? parseInt(row[4]) : null;
                                matches[idx].awayScore = row[5] !== '' ? parseInt(row[5]) : null;
                            }
                        }
                    });
                }

                // Ø®ÙˆØ§Ù†Ø¯Ù† Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù†
                const playersSheet = workbook.Sheets['Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù†'];
                if (playersSheet) {
                    const playersDataList = XLSX.utils.sheet_to_json(playersSheet, { header: 1 });
                    playersDataList.shift();
                    
                    playersData = {};
                    teamManagers = {};
                    
                    playersDataList.forEach(row => {
                        if (row.length >= 6) {
                            const team = row[0];
                            const manager = row[1];
                            const playerName = row[2];
                            const goals = parseInt(row[3]) || 0;
                            const yellow = parseInt(row[4]) || 0;
                            const red = parseInt(row[5]) || 0;
                            
                            if (!playersData[team]) {
                                playersData[team] = [];
                                teamManagers[team] = manager;
                            }
                            
                            playersData[team].push({
                                name: playerName,
                                goals: goals,
                                yellow: yellow,
                                red: red
                            });
                        }
                    });
                }

                // Ø®ÙˆØ§Ù†Ø¯Ù† Ù…Ø±Ø­Ù„Ù‡ Ø­Ø°ÙÛŒ
                const koSheet = workbook.Sheets['Ù…Ø±Ø­Ù„Ù‡ Ø­Ø°ÙÛŒ'];
                if (koSheet) {
                    const koData = XLSX.utils.sheet_to_json(koSheet, { header: 1 });
                    koData.shift();
                    
                    koData.forEach((row, idx) => {
                        if (row.length >= 5 && knockoutMatches[idx]) {
                            knockoutMatches[idx].teams[0] = row[1] || '';
                            knockoutMatches[idx].teams[1] = row[2] || '';
                            knockoutMatches[idx].score[0] = row[3] !== '' ? parseInt(row[3]) : null;
                            knockoutMatches[idx].score[1] = row[4] !== '' ? parseInt(row[4]) : null;
                        }
                    });
                }

                // Ø®ÙˆØ§Ù†Ø¯Ù† ØªÙˆØ¶ÛŒØ­Ø§Øª Ú©Ù„ÛŒ
                const descSheet = workbook.Sheets['ØªÙˆØ¶ÛŒØ­Ø§Øª Ú©Ù„ÛŒ'];
                if (descSheet) {
                    const descData = XLSX.utils.sheet_to_json(descSheet, { header: 1 });
                    if (descData.length > 1) {
                        description = descData[1][0] || description;
                    }
                }

                autoSave();
                renderAll();
                alert('âœ… ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯.');
            };

            reader.readAsArrayBuffer(file);
            e.target.value = '';
        });

        // Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ø± 30 Ø«Ø§Ù†ÛŒÙ‡
        setInterval(autoSave, 30000);
    </script>
</body>
</html>
